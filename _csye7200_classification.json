{"paragraphs":[{"text":"%spark2.spark\n\nval s = spark.version","user":"admin","dateUpdated":"2018-04-17T23:22:20+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ns: String = 2.1.1.2.6.1.4-2\n"}]},"apps":[],"jobName":"paragraph_1524007317411_722499867","id":"20180415-033533_1768366937","dateCreated":"2018-04-17T23:21:57+0000","dateStarted":"2018-04-17T23:22:20+0000","dateFinished":"2018-04-17T23:22:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4959"},{"text":"%spark2.spark\n\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.{Dataset, SparkSession}\n\nval schema: StructType = new StructType(Array(StructField(\"date\", StringType, false),\n    StructField(\"game_size\", IntegerType, false),\n    StructField(\"match_id\",StringType, false),\n    StructField(\"match_mode\", StringType, false),\n    StructField(\"party_size\", IntegerType, false),\n    StructField(\"player_assists\", IntegerType, false),\n    StructField(\"player_dbno\",IntegerType,false),\n    StructField(\"player_dist_ride\",DoubleType,false),\n    StructField(\"player_dist_walk\",DoubleType,false),\n    StructField(\"player_dmg\",IntegerType,false),\n    StructField(\"player_kills\",IntegerType,false),\n    StructField(\"player_name\",StringType,false),\n    StructField(\"player_survive_time\",DoubleType,false),\n    StructField(\"team_id\",IntegerType,false),\n    StructField(\"team_placement\",IntegerType,false))\n  )\n\ncase class Player (game_size: Int, match_id: String, match_mode: String, party_size: Int,\n                   player_assists: Int, player_dbno: Int, player_dist_ride: Double, player_dist_walk: Double,\n                   player_dmg: Int, player_kills: Int, player_name: String, player_survive_time: Double,\n                   team_id: Int, team_placement: Int)\n                   \ndef ingest(spark: SparkSession, srcDir: String, schema: StructType): Dataset[Player]  = {\n\n    import spark.implicits._\n\n    spark.read\n      .option(\"header\", \"true\")\n      .option(\"inferSchema\", \"false\")\n      .schema(schema)\n      .format(\"csv\")\n      .load(srcDir)\n      .as[Player]\n  }\n\nval path = \"s3a://csye7200.bucket.forfinal/aggregate/*\"\n\nval ds = ingest(spark, path, schema)\n","user":"admin","dateUpdated":"2018-04-18T03:12:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.types._\n\nimport org.apache.spark.sql.{Dataset, SparkSession}\n\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(date,StringType,false), StructField(game_size,IntegerType,false), StructField(match_id,StringType,false), StructField(match_mode,StringType,false), StructField(party_size,IntegerType,false), StructField(player_assists,IntegerType,false), StructField(player_dbno,IntegerType,false), StructField(player_dist_ride,DoubleType,false), StructField(player_dist_walk,DoubleType,false), StructField(player_dmg,IntegerType,false), StructField(player_kills,IntegerType,false), StructField(player_name,StringType,false), StructField(player_survive_time,DoubleType,false), StructField(team_id,IntegerType,false), StructField(team_placement,IntegerType,false))\n\ndefined class Player\n\ningest: (spark: org.apache.spark.sql.SparkSession, srcDir: String, schema: org.apache.spark.sql.types.StructType)org.apache.spark.sql.Dataset[Player]\n\npath: String = s3a://csye7200.bucket.forfinal/aggregate/*\n\nds: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524007317416_719037126","id":"20180415-033606_692903529","dateCreated":"2018-04-17T23:21:57+0000","dateStarted":"2018-04-18T03:12:56+0000","dateFinished":"2018-04-18T03:13:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4960"},{"text":"%spark2.spark\n\nimport org.apache.spark.ml.classification.{MultilayerPerceptronClassificationModel, MultilayerPerceptronClassifier, RandomForestClassifier,RandomForestClassificationModel}\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.feature.{Normalizer, VectorAssembler}\nimport org.apache.spark.sql.{DataFrame, Dataset}\nimport org.apache.spark.sql.functions.udf\n\nobject Classification {\n  def buildingModel(ds: Dataset[Player]): Array[MultilayerPerceptronClassificationModel] = {\n    def buildModelHelper(ds: Dataset[Player]): MultilayerPerceptronClassificationModel = {\n      val dataFrame = createDfWithFeature(ds).cache()\n      val splits = dataFrame.randomSplit(Array(0.7, 0.3), seed = 1L)\n      val trian =splits(0)\n      val test = splits(1)\n      //The layer number and node size of NN was determined according to StackOverflow answers: https://stats.stackexchange.com/questions/181/how-to-choose-the-number-of-hidden-layers-and-nodes-in-a-feedforward-neural-netw?utm_medium=organic&utm_source=google_rich_qa&utm_campaign=google_rich_qa\n      val layers = Array(7, 5, 2)\n      val trainer = new MultilayerPerceptronClassifier()\n          .setLayers(layers)\n          .setLabelCol(\"survived\")\n          .setMaxIter(300)\n          .setSeed(1234L)\n\n      val model = trainer.fit(trian)\n      val result = model.transform(test)\n      val predictionLabels = result.select(\"prediction\", \"survived\")\n      val evaluator = new MulticlassClassificationEvaluator().setMetricName(\"accuracy\").setLabelCol(\"survived\")\n      println(\"Test set accuracy = \" + evaluator.evaluate(predictionLabels))\n      model\n    }\n\n    val soloPlayers = ds.filter(d => d.party_size == 1).cache()\n    val duoPlayers = ds.filter(d => d.party_size == 2).cache()\n    val squadPlayers = ds.filter(d => d.party_size == 4).cache()\n\n    val models = Array(soloPlayers, duoPlayers, squadPlayers).map(pd => buildModelHelper(pd))\n    models\n  }\n\n  def buildingRFModels(ds: Dataset[Player]): Array[RandomForestClassificationModel] = {\n    def buildModelHelper(ds: Dataset[Player]): RandomForestClassificationModel = {\n      val dataFrame = createDfWithFeature(ds).cache()\n      val splits = dataFrame.randomSplit(Array(0.7, 0.3), seed = 1L)\n      val trian =splits(0)\n      val test = splits(1)\n\n      val trainer = new RandomForestClassifier()\n        .setLabelCol(\"survived\")\n        .setNumTrees(100)\n        .setSeed(1234L)\n\n      val model = trainer.fit(trian)\n      val result = model.transform(test)\n      val predictionLabels = result.select(\"prediction\", \"survived\")\n      val evaluator = new MulticlassClassificationEvaluator().setMetricName(\"accuracy\").setLabelCol(\"survived\")\n      println(\"Test set accuracy = \" + evaluator.evaluate(predictionLabels))\n      model\n    }\n\n    val soloPlayers = ds.filter(d => d.party_size == 1).cache()\n    val duoPlayers = ds.filter(d => d.party_size == 2).cache()\n    val squadPlayers = ds.filter(d => d.party_size == 4).cache()\n\n    val models = Array(soloPlayers, duoPlayers, squadPlayers).map(pd => buildModelHelper(pd))\n    models\n  }\n    \n  def createDfWithFeature(ds: Dataset[Player]): DataFrame ={\n    val isWinnerUdf = udf((placement: Int) => placement match {\n      case 1 => 1\n      case _ => 0\n    })\n    val colArray = Array(\"player_assists\", \"player_dbno\", \"player_dist_ride\", \"player_dist_walk\", \"player_dmg\", \"player_kills\", \"player_survive_time\")\n    val vecAss = new VectorAssembler().setInputCols(colArray).setOutputCol(\"feature_unnormalized\")\n    val normalizer = new Normalizer().setInputCol(\"feature_unnormalized\").setOutputCol(\"features\")\n    val df_temp_1 = vecAss.transform(ds)\n    val df_temp_2 = normalizer.transform(df_temp_1)\n    val resultDf = df_temp_2.withColumn(\"survived\", isWinnerUdf(df_temp_2(\"team_placement\")))\n    resultDf\n  }\n\n  def filtPlayers(ds: Dataset[Player]): Dataset[Player] = {\n    //We need to filter abnormal data. Some players have \"0\" as team_placement, which do not affect clustering but obviously affect classification.\n    val filterdPlayers = ds.filter(d => (d.player_dist_ride != 0 || d.player_dist_walk != 0)\n      && d.player_survive_time <= 2400\n      && d.team_placement > 0)\n    filterdPlayers\n  }\n}","user":"admin","dateUpdated":"2018-04-18T03:13:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.classification.{MultilayerPerceptronClassificationModel, MultilayerPerceptronClassifier, RandomForestClassifier, RandomForestClassificationModel}\n\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\n\nimport org.apache.spark.ml.feature.{Normalizer, VectorAssembler}\n\nimport org.apache.spark.sql.{DataFrame, Dataset}\n\nimport org.apache.spark.sql.functions.udf\n\ndefined object Classification\n"}]},"apps":[],"jobName":"paragraph_1524007317417_718652378","id":"20180417-012533_1130211488","dateCreated":"2018-04-17T23:21:57+0000","dateStarted":"2018-04-18T03:13:50+0000","dateFinished":"2018-04-18T03:13:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4961"},{"text":"%spark2.spark\n\nval models = Classification.buildingModel(ds)","dateUpdated":"2018-04-17T23:21:57+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\norg.apache.spark.SparkException: Job 96 cancelled part of cancelled job group zeppelin-20180417-012558_1757199068\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1435)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1375)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:788)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1625)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1605)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1594)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1925)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1938)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1951)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1965)\n  at org.apache.spark.rdd.RDD.count(RDD.scala:1158)\n  at org.apache.spark.mllib.optimization.LBFGS$.runLBFGS(LBFGS.scala:195)\n  at org.apache.spark.mllib.optimization.LBFGS.optimize(LBFGS.scala:142)\n  at org.apache.spark.ml.ann.FeedForwardTrainer.train(Layer.scala:817)\n  at org.apache.spark.ml.classification.MultilayerPerceptronClassifier.train(MultilayerPerceptronClassifier.scala:260)\n  at org.apache.spark.ml.classification.MultilayerPerceptronClassifier.train(MultilayerPerceptronClassifier.scala:145)\n  at org.apache.spark.ml.Predictor.fit(Predictor.scala:96)\n  at $$$$2f67deb34ff5a9c1a54034a06da8e9ff$$$$Classification$.$line1560542907211$$read$Classification$$buildModelHelper$1(<console>:163)\n  at $$$$2f67deb34ff5a9c1a54034a06da8e9ff$$$$Classification$$anonfun$5.apply(<console>:175)\n  at $$$$2f67deb34ff5a9c1a54034a06da8e9ff$$$$Classification$$anonfun$5.apply(<console>:175)\n  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n  at scala.collection.IndexedSeqOptimized$class.foreach(IndexedSeqOptimized.scala:33)\n  at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:186)\n  at scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n  at scala.collection.mutable.ArrayOps$ofRef.map(ArrayOps.scala:186)\n  at $$$$2f67deb34ff5a9c1a54034a06da8e9ff$$$$Classification$.buildingModel(<console>:175)\n  ... 66 elided\n"}]},"apps":[],"jobName":"paragraph_1524007317418_719806624","id":"20180417-012558_1757199068","dateCreated":"2018-04-17T23:21:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4962"},{"text":"%spark2.spark\nmodels(0).save(\"s3a://csye7200.bucket.forfinal/Models/nnClassifierForSolo\")\nmodels(1).save(\"s3a://csye7200.bucket.forfinal/Models/nnClassifierForDuo\")\nmodels(2).save(\"s3a://csye7200.bucket.forfinal/Models/nnClassifierForSquad\")","dateUpdated":"2018-04-17T23:21:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524007317419_719421875","id":"20180417-035755_1533361892","dateCreated":"2018-04-17T23:21:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4963"},{"text":"%spark2.spark\nds.cache.show\n\n\n","dateUpdated":"2018-04-17T23:21:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+\n|                date|game_size|            match_id|match_mode|party_size|player_assists|player_dbno|  player_dist_ride|  player_dist_walk|player_dmg|player_kills|   player_name|player_survive_time|team_id|team_placement|\n+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|          2870.724|        1784.84778|       117|           1|      SnuffIes|            1106.32|      4|            18|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|2938.4072300000003|1756.0797100000002|       127|           1|        Ozon3r|           1106.315|      4|            18|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        224.157562|        67|           0|        bovize|            235.558|      5|            33|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          92.93515|         0|           0|       sbahn87|            197.553|      5|            33|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|        2619.07739|          2510.447|       175|           2|     GeminiZZZ|           1537.495|     14|            11|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|         2896.3125|        2167.93213|        65|           0|      AlexWho6|             1537.5|     14|            11|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        3118.58032|         0|           0|    R1dd1ck913|           1264.792|     15|            17|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          3237.202|         0|           0|     Emmylou89|           1264.795|     15|            17|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|         1552.3147|        79|           0|         ron-n|             868.56|     17|            24|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|         1450.3147|       101|           1|       SoSpicy|            868.555|     17|            24|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|        2406.55469|        3100.02124|        54|           1|   MatthiasXIV|           1939.846|     22|             4|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|        3135.38647|2456.2775899999997|        34|           0|      Ninjapex|           1939.851|     22|             4|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        55.2714539|         0|           0|    thebrewski|             160.64|     24|            34|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|          129.4159|       215|           2|GucciManeDrain| 180.90099999999998|     24|            34|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|          2418.547|        2474.08887|        75|           1|      subzero3|           2181.815|     25|             2|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|1277.5805699999999|        3286.67114|        84|           1|       Chogo82|            2181.82|     25|             2|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          2057.258|         0|           0|    FIYMNBVCXZ| 1583.1570000000002|     26|             3|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          4|               0.0|        3285.94385|       673|           6|     ShuLanHou| 2009.7220000000002|     26|             3|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        1522.11768|       117|           1|         sigbo| 1032.6480000000001|     29|            20|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|        1078.95581|       100|           1|       Jerryxp|            513.487|     29|            20|\n+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1524007317420_717498131","id":"20180415-214514_1994102395","dateCreated":"2018-04-17T23:21:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4964"},{"text":"%spark2.spark\nval rfModels = Classification.buildingRFModels(ds)","user":"admin","dateUpdated":"2018-04-17T23:26:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Test set accuracy = 0.9891577563669826\nTest set accuracy = 0.9785052639146727\nTest set accuracy = 0.9597469032400867\n\nrfModels: Array[org.apache.spark.ml.classification.RandomForestClassificationModel] = Array(RandomForestClassificationModel (uid=rfc_769daabab923) with 100 trees, RandomForestClassificationModel (uid=rfc_bcc270c067ac) with 100 trees, RandomForestClassificationModel (uid=rfc_18b65084a0cb) with 100 trees)\n"}]},"apps":[],"jobName":"paragraph_1524007317421_717113382","id":"20180417-195656_665350291","dateCreated":"2018-04-17T23:21:57+0000","dateStarted":"2018-04-17T23:26:26+0000","dateFinished":"2018-04-18T01:27:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4965"},{"text":"%spark2.spark\nrfModels(0).save(\"s3a://csye7200.bucket.forfinal/Models/rfClassifierForSolo\")\nrfModels(1).save(\"s3a://csye7200.bucket.forfinal/Models/rfClassifierForDuo\")\nrfModels(2).save(\"s3a://csye7200.bucket.forfinal/Models/rfClassifierForSquad\")\n","user":"admin","dateUpdated":"2018-04-18T01:28:54+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524007317421_717113382","id":"20180417-222527_947541500","dateCreated":"2018-04-17T23:21:57+0000","dateStarted":"2018-04-18T01:28:54+0000","dateFinished":"2018-04-18T01:29:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4966"},{"text":"%spark2.spark\nval soloPlayers = ds.filter(d => d.party_size == 1).cache()\nval duoPlayers = ds.filter(d => d.party_size == 2).cache()\nval squadPlayers = ds.filter(d => d.party_size == 4).cache()\n","user":"admin","dateUpdated":"2018-04-18T03:22:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nsoloPlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n\nduoPlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n\nsquadPlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524014934908_-957159313","id":"20180418-012854_1610772296","dateCreated":"2018-04-18T01:28:54+0000","dateStarted":"2018-04-18T03:22:19+0000","dateFinished":"2018-04-18T03:22:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4967"},{"text":"%spark2.spark\nval soloInput = Classification.createDfWithFeature(soloPlayers)\nval duoInput = Classification.createDfWithFeature(duoPlayers)\nval squadInput = Classification.createDfWithFeature(squadPlayers)\n\nval soloResult = rfModels(0).transform(soloInput).cache\nval duoResult = rfModels(1).transform(duoInput).cache\nval squadResult = rfModels(2).transform(squadInput)cache\n\nsoloResult.createOrReplaceTempView(\"soloView\")\nduoResult.createOrReplaceTempView(\"duoView\")\nsquadResult.createOrReplaceTempView(\"squadView\")","user":"admin","dateUpdated":"2018-04-18T03:22:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"\nsoloInput: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 16 more fields]\n\nduoInput: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 16 more fields]\n\nsquadInput: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 16 more fields]\n\n\n\n<console>:61: error: not found: value rfModels\n       val soloResult = rfModels(0).transform(soloInput).cache\n                        ^\n"}]},"apps":[],"jobName":"paragraph_1524014995944_-837609674","id":"20180418-012955_1439225945","dateCreated":"2018-04-18T01:29:55+0000","dateStarted":"2018-04-18T03:22:21+0000","dateFinished":"2018-04-18T03:22:21+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:4968"},{"text":"%spark2.sql\nSELECT prediction, SUM(1) AS numEachCluster FROM soloView GROUP BY prediction","user":"admin","dateUpdated":"2018-04-18T01:50:04+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\tnumEachCluster\n0.0\t14039579\n1.0\t70\n"}]},"apps":[],"jobName":"paragraph_1524015175229_-1270220156","id":"20180418-013255_705585260","dateCreated":"2018-04-18T01:32:55+0000","dateStarted":"2018-04-18T01:33:17+0000","dateFinished":"2018-04-18T01:49:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4969"},{"text":"%spark2.spark\nsoloResult.where(\"prediction == 1\").drop(\"date\", \"game_size\", \"match_id\")show(70)\n","user":"admin","dateUpdated":"2018-04-18T01:54:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+----------+--------------+-----------+----------------+------------------+----------+------------+----------------+-------------------+-------+--------------+--------------------+--------------------+--------+--------------------+--------------------+----------+\n|match_mode|party_size|player_assists|player_dbno|player_dist_ride|  player_dist_walk|player_dmg|player_kills|     player_name|player_survive_time|team_id|team_placement|feature_unnormalized|            features|survived|       rawPrediction|         probability|prediction|\n+----------+----------+--------------+-----------+----------------+------------------+----------+------------+----------------+-------------------+-------+--------------+--------------------+--------------------+--------+--------------------+--------------------+----------+\n|       tpp|         1|             1|          0|             0.0| 6821.150390000001|      3963|          39|  6oB2-5-5-7-7-3|           1363.901| 100098|             1|[1.0,0.0,0.0,6821...|[1.24907125504451...|       1|[47.9852459041965...|[0.47985245904196...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          8323.791|      3507|          37| QQqun_648314099|           1223.432| 100066|             1|[0.0,0.0,0.0,8323...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          7337.469|      3088|          31|    WGqun_200038| 1504.7220000000002| 100071|             1|[0.0,0.0,0.0,7337...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|7905.2390000000005|      4794|          49| QQqun648314099-|           1239.904| 100046|             1|[1.0,0.0,0.0,7905...|[1.07202010126287...|       1|[49.2778021031371...|[0.49277802103137...|       1.0|\n|       tpp|         1|             1|          0|             0.0|        8173.16455|      4737|          48| Qun__64831_4099|           1407.895| 100025|             1|[1.0,0.0,0.0,8173...|[1.04699551872302...|       1|[47.9852459041965...|[0.47985245904196...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9659.063|      4395|          44| QQqun648314099-|           1271.531| 100057|             1|[0.0,0.0,0.0,9659...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|           9015.19|      3926|          40|   kejiqun951073|           1333.432| 100088|             1|[0.0,0.0,0.0,9015...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|3409.8781700000004|      1484|          15| WG-Qun301323278|            612.186| 100076|            37|[0.0,0.0,0.0,3409...|[0.0,0.0,0.0,0.90...|       0|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          7311.286|      3639|          37|664301849-QUN-KK| 1329.5810000000001| 100093|             1|[1.0,0.0,0.0,7311...|[1.20854080418411...|       1|[47.8045245724561...|[0.47804524572456...|       1.0|\n|       tpp|         1|             1|          0|             0.0|         10071.751|      4109|          39| QQqun-648314099|           1195.715| 100087|             1|[1.0,0.0,0.0,1007...|[9.13803081805472...|       1|[47.9878564125485...|[0.47987856412548...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          7661.149|      3105|          31|    liujiachuang| 1508.3010000000002| 100041|             1|[0.0,0.0,0.0,7661...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9212.909|      3663|          36|   WG_QUN_567435|           1670.192| 100057|             1|[0.0,0.0,0.0,9212...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|6058.5019999999995|      3412|          34| qun-648314099-G|           1223.593| 100075|             1|[1.0,0.0,0.0,6058...|[1.41640321097534...|       1|[49.9048943570417...|[0.49904894357041...|       1.0|\n|       tpp|         1|             1|          0|             0.0| 8130.040529999999|      4773|          49|  33l663NiDongDe|           1163.622| 100039|             1|[1.0,0.0,0.0,8130...|[1.05271611353053...|       1|[47.9852459041965...|[0.47985245904196...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9687.145|      4031|          43|   WeiXin_vkeg99| 1246.6760000000002| 100091|             1|[0.0,0.0,0.0,9687...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          8642.994|      4284|          41| Wg-Qun231344580| 1491.2279999999998| 100045|             1|[1.0,0.0,0.0,8642...|[1.02447270592231...|       1|[48.3363877753087...|[0.48336387775308...|       1.0|\n|       tpp|         1|             0|          0|             0.0|         4683.4873|      2034|          20|    Vx_old9style|  724.4989999999999| 100027|            27|[0.0,0.0,0.0,4683...|[0.0,0.0,0.0,0.90...|       0|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          9831.826|      5743|          61|WG-Qun326373092-|           1198.123| 100030|             1|[1.0,0.0,0.0,9831...|[8.73417168844495...|       1|[47.9852459041965...|[0.47985245904196...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 9747.565999999999|      4395|          47|    zf-29677ll4l|           1185.271| 100036|             1|[0.0,0.0,0.0,9747...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 8378.976999999999|      3678|          39|    TT-Killerone| 1237.5910000000001| 100079|             1|[0.0,0.0,0.0,8378...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 8027.305659999999|      3615|          38|       5I265O6IO| 1222.7160000000001| 100071|             1|[0.0,0.0,0.0,8027...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9533.919|      3988|          42|   WG-23988-6080|            1296.27| 100040|             1|[0.0,0.0,0.0,9533...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        7677.07959|      2956|          32|       366898408| 1502.1870000000001| 100075|             1|[0.0,0.0,0.0,7677...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        8563.89551|      3851|          41|    zf-29677ll4l|           1300.879| 100087|             1|[0.0,0.0,0.0,8563...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9016.046|      4040|          42| FZ-qun242890139| 1369.5739999999998| 100020|             1|[0.0,0.0,0.0,9016...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          8837.888|      3974|          41|     0vn_33l_663|           1420.055| 100080|             1|[1.0,0.0,0.0,8837...|[1.02105062311490...|       1|[47.7164867732950...|[0.47716486773295...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        6676.62354|      2548|          27|   WG-23988-6080| 1377.8270000000002| 100076|             9|[0.0,0.0,0.0,6676...|[0.0,0.0,0.0,0.91...|       0|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 7201.933000000001|      2822|          29| www-waiguaw--cn|           1327.815| 100034|             1|[0.0,0.0,0.0,7201...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|           7866.66|      3518|          34|      sssss_pipi|           1443.017| 100014|             1|[1.0,0.0,0.0,7866...|[1.14449053978770...|       1|[47.7164867732950...|[0.47716486773295...|       1.0|\n|       tpp|         1|             1|          0|             0.0| 7958.224609999999|      3946|          34|     33l663XQunX|           1603.348| 100039|             1|[1.0,0.0,0.0,7958...|[1.10785975410967...|       1|[48.3363877753087...|[0.48336387775308...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          8559.664|      4080|          41|      qq33058254| 1342.3929999999998| 100084|             1|[1.0,0.0,0.0,8559...|[1.04417389972162...|       1|[47.7164867732950...|[0.47716486773295...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        11522.9434|      4881|          50| QQqun-648314099|           1317.828| 100035|             1|[0.0,0.0,0.0,1152...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0| 8654.809000000001|      3965|          42|  OVN_6556_07504|           1303.872| 100038|             1|[1.0,0.0,0.0,8654...|[1.04071406884859...|       1|[47.7164867732950...|[0.47716486773295...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9069.695|      3682|          39|        FATHER-7|           1405.705| 100046|             1|[0.0,0.0,0.0,9069...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|5973.6669999999995|      2422|          25| QQ_qun648314099|  933.4910000000001| 100057|            28|[0.0,0.0,0.0,5973...|[0.0,0.0,0.0,0.91...|       0|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 8048.865720000001|      3263|          33| 517042658WGqun_|           1658.254| 100013|             1|[0.0,0.0,0.0,8048...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|         10251.999|      4417|          45|QQ-Qun606-172407| 1640.3239999999998| 100062|             1|[0.0,0.0,0.0,1025...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          8045.655|      3322|          32|  Gqun_630685834|           1631.358| 100037|             1|[0.0,0.0,0.0,8045...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        5183.54834|      2159|          24|          XM_BBQ| 1014.3889999999999| 100001|            25|[0.0,0.0,0.0,5183...|[0.0,0.0,0.0,0.90...|       0|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          11870.43|      5308|          53| QQqun-648314099|           1411.254| 100026|             1|[0.0,0.0,0.0,1187...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 8320.636999999999|      3455|          37|  yema-301323278| 1573.6589999999999| 100017|             1|[0.0,0.0,0.0,8320...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          8611.771|      3681|          39|  WG-50536606qun|           1424.526| 100029|             1|[0.0,0.0,0.0,8611...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          7503.516|      3345|          37|      qq33058254|           1355.098| 100054|             1|[1.0,0.0,0.0,7503...|[1.20099489199222...|       1|[47.7164867732950...|[0.47716486773295...|       1.0|\n|       tpp|         1|             1|          0|             0.0|        12204.6611|      4813|          52|    qiyun2920293|           1341.131| 100099|             1|[1.0,0.0,0.0,1220...|[7.58272250655914...|       1|[47.9878564125485...|[0.47987856412548...|       1.0|\n|       tpp|         1|             1|          0|             0.0|6963.9326200000005|      2775|          28|  Gqun_580856767|           1351.172| 100005|             1|[1.0,0.0,0.0,6963...|[1.31279915512946...|       1|[49.2210780774259...|[0.49221078077425...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        12494.4209|      5494|          57| 2Vx-shenxian852|           1390.285| 100080|             1|[0.0,0.0,0.0,1249...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          10404.96|      4720|          49| QQqun-648314099|           1177.994| 100088|             1|[0.0,0.0,0.0,1040...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          8524.579|      3314|          33|    67_18_40_853|           1755.265| 100089|             1|[0.0,0.0,0.0,8524...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          8693.579|      5403|          57|       343659GzH|           1237.687| 100072|             1|[1.0,0.0,0.0,8693...|[9.69887651994033...|       1|[49.2778021031371...|[0.49277802103137...|       1.0|\n|       tpp|         1|             1|          0|             0.0| 8256.943000000001|      4630|          50|  33l663NiDongDe|            1453.75| 100056|             1|[1.0,0.0,0.0,8256...|[1.04410588891298...|       1|[47.9852459041965...|[0.47985245904196...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        10375.0078|      4194|          41|  598177674_keji|           1506.773| 100031|             1|[0.0,0.0,0.0,1037...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9114.024|      4034|          42|    qiyun292O293| 1267.9489999999998| 100021|             1|[0.0,0.0,0.0,9114...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 8520.046999999999|      3445|          37|       512650610|           1242.378| 100044|             1|[0.0,0.0,0.0,8520...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|           8905.42|      3733|          41| QQ_qun648314099| 1408.4979999999998| 100033|             1|[0.0,0.0,0.0,8905...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        7978.45068|      3148|          34|   kejiqun951073|            1388.75| 100079|             1|[0.0,0.0,0.0,7978...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9031.517|      3820|          42|         YKLsibi|           1403.068| 100066|             1|[0.0,0.0,0.0,9031...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|        7857.48438|      3532|          38|          l56624|           1242.035| 100092|             1|[0.0,0.0,0.0,7857...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9307.123|      3966|          39|          MacOSX|            1334.68| 100059|             1|[0.0,0.0,0.0,9307...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0| 6812.350590000001|      3544|          37|   wudiderendddd|           1502.405| 100014|             1|[1.0,0.0,0.0,6812...|[1.27799678275966...|       1|[47.9852459041965...|[0.47985245904196...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          8376.155|      3563|          40| jia_Vx_xuke0990|           1294.734| 100065|             1|[0.0,0.0,0.0,8376...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          7399.315|      3046|          29|    Come567on435| 1272.2160000000001| 100014|             4|[0.0,0.0,0.0,7399...|[0.0,0.0,0.0,0.91...|       0|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|           9302.48|      4105|          43|      Dalililiii| 1500.4279999999999| 100020|             1|[0.0,0.0,0.0,9302...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          8863.599|      4061|          40| WG-Qun301323278|           1309.451| 100016|             1|[1.0,0.0,0.0,8863...|[1.01654486920657...|       1|[47.7164867732950...|[0.47716486773295...|       1.0|\n|       tpp|         1|             1|          0|             0.0|          8902.952|      4278|          43|SX-Qqun238252503|           1546.307| 100061|             1|[1.0,0.0,0.0,8902...|[1.00021630189676...|       1|[47.7164867732950...|[0.47716486773295...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9255.093|      4194|          41|G644_q_un736_750|           1267.315| 100056|             1|[0.0,0.0,0.0,9255...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|           8655.84|      3817|          35|  CN___Warmonger|            1533.75| 100093|             1|[0.0,0.0,0.0,8655...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|          9013.911|      3508|          35|          iouoiu|           1596.364| 100071|             1|[0.0,0.0,0.0,9013...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0| 7990.808590000001|      3285|          33|Wg__qun644736750| 1380.9170000000001| 100055|             1|[0.0,0.0,0.0,7990...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|           9135.47|      3610|          40|    67_18_40_853|           1509.025| 100019|             1|[0.0,0.0,0.0,9135...|[0.0,0.0,0.0,0.91...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n|       tpp|         1|             0|          0|             0.0|           8729.36|      3675|          39|    67_18_40_853|            1529.11| 100091|             1|[0.0,0.0,0.0,8729...|[0.0,0.0,0.0,0.90...|       1|[49.8169372623138...|[0.49816937262313...|       1.0|\n+----------+----------+--------------+-----------+----------------+------------------+----------+------------+----------------+-------------------+-------+--------------+--------------------+--------------------+--------+--------------------+--------------------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1524015197589_1731251986","id":"20180418-013317_254226812","dateCreated":"2018-04-18T01:33:17+0000","dateStarted":"2018-04-18T01:54:37+0000","dateFinished":"2018-04-18T01:54:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4970"},{"text":"%spark2.spark\n\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\n\n def createDfWithFeature(ds: Dataset[Player]): DataFrame ={\n    val isWinnerUdf = udf((placement: Int) => placement match {\n      case 1 => 1\n      case _ => 0\n    })\n    val colArray = Array(\"player_dist_ride\", \"player_dist_walk\", \"player_dmg\", \"player_kills\", \"player_survive_time\")\n    val vecAss = new VectorAssembler().setInputCols(colArray).setOutputCol(\"feature_unnormalized\")\n    val normalizer = new Normalizer().setInputCol(\"feature_unnormalized\").setOutputCol(\"features\")\n    val df_temp_1 = vecAss.transform(ds)\n    val df_temp_2 = normalizer.transform(df_temp_1)\n    val resultDf = df_temp_2.withColumn(\"survived\", isWinnerUdf(df_temp_2(\"team_placement\")))\n    resultDf\n  }\n\n    def buildModelHelper(ds: Dataset[Player]): RandomForestClassificationModel = {\n      val dataFrame = createDfWithFeature(ds).cache()\n      val splits = dataFrame.randomSplit(Array(0.7, 0.3), seed = 1L)\n      val trian =splits(0)\n      val test = splits(1)\n\n     val trainer = new RandomForestClassifier()\n        .setLabelCol(\"survived\")\n        .setNumTrees(100)\n        .setSeed(1234L)\n\n      val model = trainer.fit(trian)\n      val result = model.transform(test)\n      val predictionLabels = result.select(\"prediction\", \"survived\")\n      val evaluator = new MulticlassClassificationEvaluator().setMetricName(\"accuracy\").setLabelCol(\"survived\")\n      println(\"Test set accuracy = \" + evaluator.evaluate(predictionLabels))\n      model \n    }\n\n   \n    \n   \n  \n","user":"admin","dateUpdated":"2018-04-18T03:56:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.classification._\n\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\n\ncreateDfWithFeature: (ds: org.apache.spark.sql.Dataset[Player])org.apache.spark.sql.DataFrame\n\nbuildModelHelper: (ds: org.apache.spark.sql.Dataset[Player])org.apache.spark.ml.classification.RandomForestClassificationModel\n"}]},"apps":[],"jobName":"paragraph_1524016602337_-617250367","id":"20180418-015642_1266773067","dateCreated":"2018-04-18T01:56:42+0000","dateStarted":"2018-04-18T03:56:35+0000","dateFinished":"2018-04-18T03:56:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4971"},{"text":"%spark2.spark\nval soloPlayers = ds.filter(d => d.party_size == 1).cache()\n\nval lrModel = buildModelHelper(soloPlayers)","user":"admin","dateUpdated":"2018-04-18T03:56:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nsoloPlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\nTest set accuracy = 0.9891705832079549\n\nlrModel: org.apache.spark.ml.classification.RandomForestClassificationModel = RandomForestClassificationModel (uid=rfc_d01696599b2c) with 100 trees\n"}]},"apps":[],"jobName":"paragraph_1524017639191_1718649385","id":"20180418-021359_1238904545","dateCreated":"2018-04-18T02:13:59+0000","dateStarted":"2018-04-18T03:56:47+0000","dateFinished":"2018-04-18T04:14:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4972"},{"text":"%spark2.spark\nval soloInput = createDfWithFeature(soloPlayers)\nval result = lrModel.transform(soloInput)","user":"admin","dateUpdated":"2018-04-18T04:19:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nsoloInput: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 16 more fields]\n\nresult: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 19 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524017818251_-1750987192","id":"20180418-021658_1821339813","dateCreated":"2018-04-18T02:16:58+0000","dateStarted":"2018-04-18T04:19:06+0000","dateFinished":"2018-04-18T04:19:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4973"},{"text":"%spark2.spark\nresult.count\nval w = result.where(\"prediction == 1\")","user":"admin","dateUpdated":"2018-04-18T04:19:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres44: Long = 14039649\n\nw: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, game_size: int ... 19 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524018346684_-615830152","id":"20180418-022546_229011621","dateCreated":"2018-04-18T02:25:46+0000","dateStarted":"2018-04-18T04:19:22+0000","dateFinished":"2018-04-18T04:19:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4974"},{"text":"%spark2.spark\nw.createOrReplaceTempView(\"sss\")","user":"admin","dateUpdated":"2018-04-18T04:19:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1524020643650_1156986034","id":"20180418-030403_188428746","dateCreated":"2018-04-18T03:04:03+0000","dateStarted":"2018-04-18T04:19:27+0000","dateFinished":"2018-04-18T04:19:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4975"},{"text":"%spark2.sql\nSELECT survived, SUM(1) AS numEachCluster FROM sss GROUP BY survived","user":"admin","dateUpdated":"2018-04-18T04:19:30+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524020782264_1352654658","id":"20180418-030622_2022119871","dateCreated":"2018-04-18T03:06:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4976","dateFinished":"2018-04-18T04:22:10+0000","dateStarted":"2018-04-18T04:19:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"survived\tnumEachCluster\n1\t359\n0\t94\n"}]}},{"text":"%spark2.sql\n","user":"admin","dateUpdated":"2018-04-18T03:28:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524022109679_-1799520869","id":"20180418-032829_448830409","dateCreated":"2018-04-18T03:28:29+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6887"}],"name":"/csye7200/classification","id":"2DD7Y4N9V","angularObjects":{"2DDRGA5ES:shared_process":[],"2DE8S1Y5S:shared_process":[],"2DB7MX7WV:shared_process":[],"2DDUNF2Y8:shared_process":[],"2DCHKC9SP:shared_process":[],"2DAG48VFX:shared_process":[],"2C4U48MY3_spark2:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}