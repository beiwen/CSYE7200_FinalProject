{"paragraphs":[{"text":"%spark2.spark\r\n\r\nval s = spark.version\r\n\r\n","dateUpdated":"2018-04-06T21:19:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523049285475_1924486543","id":"20180328-175926_1547420404","dateCreated":"2018-04-06T21:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:267","user":"admin","dateFinished":"2018-04-06T21:19:36+0000","dateStarted":"2018-04-06T21:19:35+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ns: String = 2.1.1.2.6.1.4-2\n"}]}},{"text":"%spark2.spark\n\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.{Dataset, SparkSession}\n\nval schema: StructType = new StructType(Array(StructField(\"date\", StringType, false),\n    StructField(\"game_size\", IntegerType, false),\n    StructField(\"match_id\",StringType, false),\n    StructField(\"match_mode\", StringType, false),\n    StructField(\"party_size\", IntegerType, false),\n    StructField(\"player_assists\", IntegerType, false),\n    StructField(\"player_dbno\",IntegerType,false),\n    StructField(\"player_dist_ride\",DoubleType,false),\n    StructField(\"player_dist_walk\",DoubleType,false),\n    StructField(\"player_dmg\",IntegerType,false),\n    StructField(\"player_kills\",IntegerType,false),\n    StructField(\"player_name\",StringType,false),\n    StructField(\"player_survive_time\",DoubleType,false),\n    StructField(\"team_id\",IntegerType,false),\n    StructField(\"team_placement\",IntegerType,false))\n  )\n\ncase class Player (game_size: Int, match_id: String, match_mode: String, party_size: Int,\n                   player_assists: Int, player_dbno: Int, player_dist_ride: Double, player_dist_walk: Double,\n                   player_dmg: Int, player_kills: Int, player_name: String, player_survive_time: Double,\n                   team_id: Int, team_placement: Int)\n                   \ndef ingest(spark: SparkSession, srcDir: String, schema: StructType): Dataset[Player]  = {\n\n    import spark.implicits._\n\n    spark.read\n      .option(\"header\", \"true\")\n      .option(\"inferSchema\", \"false\")\n      .schema(schema)\n      .format(\"csv\")\n      .load(srcDir)\n      .as[Player]\n  }\n\nval path = \"s3a://csye7200.bucket.forfinal/aggregate/*\"\n\nval ds = ingest(spark, path, schema)","dateUpdated":"2018-04-06T21:20:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523049285476_1922562799","id":"20180328-180120_458270262","dateCreated":"2018-04-06T21:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268","user":"admin","dateFinished":"2018-04-06T21:20:09+0000","dateStarted":"2018-04-06T21:20:05+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.types._\n\nimport org.apache.spark.sql.{Dataset, SparkSession}\n\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(date,StringType,false), StructField(game_size,IntegerType,false), StructField(match_id,StringType,false), StructField(match_mode,StringType,false), StructField(party_size,IntegerType,false), StructField(player_assists,IntegerType,false), StructField(player_dbno,IntegerType,false), StructField(player_dist_ride,DoubleType,false), StructField(player_dist_walk,DoubleType,false), StructField(player_dmg,IntegerType,false), StructField(player_kills,IntegerType,false), StructField(player_name,StringType,false), StructField(player_survive_time,DoubleType,false), StructField(team_id,IntegerType,false), StructField(team_placement,IntegerType,false))\n\ndefined class Player\n\ningest: (spark: org.apache.spark.sql.SparkSession, srcDir: String, schema: org.apache.spark.sql.types.StructType)org.apache.spark.sql.Dataset[Player]\n\npath: String = s3a://csye7200.bucket.forfinal/aggregate/*\n\nds: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n"}]}},{"text":"%spark2.spark\nds.show()","dateUpdated":"2018-04-06T21:20:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523049285476_1922562799","id":"20180328-180819_1777898857","dateCreated":"2018-04-06T21:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:269","user":"admin","dateFinished":"2018-04-06T21:20:22+0000","dateStarted":"2018-04-06T21:20:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+\n|                date|game_size|            match_id|match_mode|party_size|player_assists|player_dbno|  player_dist_ride|  player_dist_walk|player_dmg|player_kills|   player_name|player_survive_time|team_id|team_placement|\n+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|          2870.724|        1784.84778|       117|           1|      SnuffIes|            1106.32|      4|            18|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|2938.4072300000003|1756.0797100000002|       127|           1|        Ozon3r|           1106.315|      4|            18|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        224.157562|        67|           0|        bovize|            235.558|      5|            33|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          92.93515|         0|           0|       sbahn87|            197.553|      5|            33|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|        2619.07739|          2510.447|       175|           2|     GeminiZZZ|           1537.495|     14|            11|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|         2896.3125|        2167.93213|        65|           0|      AlexWho6|             1537.5|     14|            11|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        3118.58032|         0|           0|    R1dd1ck913|           1264.792|     15|            17|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          3237.202|         0|           0|     Emmylou89|           1264.795|     15|            17|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|         1552.3147|        79|           0|         ron-n|             868.56|     17|            24|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|         1450.3147|       101|           1|       SoSpicy|            868.555|     17|            24|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|        2406.55469|        3100.02124|        54|           1|   MatthiasXIV|           1939.846|     22|             4|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|        3135.38647|2456.2775899999997|        34|           0|      Ninjapex|           1939.851|     22|             4|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        55.2714539|         0|           0|    thebrewski|             160.64|     24|            34|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|          129.4159|       215|           2|GucciManeDrain| 180.90099999999998|     24|            34|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|          2418.547|        2474.08887|        75|           1|      subzero3|           2181.815|     25|             2|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|1277.5805699999999|        3286.67114|        84|           1|       Chogo82|            2181.82|     25|             2|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          2057.258|         0|           0|    FIYMNBVCXZ| 1583.1570000000002|     26|             3|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          4|               0.0|        3285.94385|       673|           6|     ShuLanHou| 2009.7220000000002|     26|             3|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        1522.11768|       117|           1|         sigbo| 1032.6480000000001|     29|            20|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|        1078.95581|       100|           1|       Jerryxp|            513.487|     29|            20|\n+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%spark2.spark\nds.printSchema()\nds.count\nds.rdd.getNumPartitions","dateUpdated":"2018-04-06T21:25:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523049285477_1922178050","id":"20180328-181711_1755236649","dateCreated":"2018-04-06T21:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:270","user":"admin","dateFinished":"2018-04-06T21:27:07+0000","dateStarted":"2018-04-06T21:25:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- date: string (nullable = true)\n |-- game_size: integer (nullable = true)\n |-- match_id: string (nullable = true)\n |-- match_mode: string (nullable = true)\n |-- party_size: integer (nullable = true)\n |-- player_assists: integer (nullable = true)\n |-- player_dbno: integer (nullable = true)\n |-- player_dist_ride: double (nullable = true)\n |-- player_dist_walk: double (nullable = true)\n |-- player_dmg: integer (nullable = true)\n |-- player_kills: integer (nullable = true)\n |-- player_name: string (nullable = true)\n |-- player_survive_time: double (nullable = true)\n |-- team_id: integer (nullable = true)\n |-- team_placement: integer (nullable = true)\n\n\nres16: Long = 67369231\n\nres17: Int = 79\n"}]}},{"text":"%spark2.spark\n\nval activePlayers = ds.filter(d => (d.player_dist_ride != 0 || d.player_dist_walk != 0))\nactivePlayers.cache\n\nactivePlayers.createOrReplaceTempView(\"acp\")","dateUpdated":"2018-04-06T23:25:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523049285477_1922178050","id":"20180328-191024_2138907868","dateCreated":"2018-04-06T21:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:271","user":"admin","dateFinished":"2018-04-06T23:25:48+0000","dateStarted":"2018-04-06T23:25:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nactivePlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n\nres26: activePlayers.type = [date: string, game_size: int ... 13 more fields]\n"}]}},{"text":"%spark2.spark\nval test = activePlayers.count\n","dateUpdated":"2018-04-06T22:05:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523049285477_1922178050","id":"20180403-183451_1600544030","dateCreated":"2018-04-06T21:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:272","user":"admin","dateFinished":"2018-04-06T21:30:23+0000","dateStarted":"2018-04-06T21:28:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ntest: Long = 65846522\n"}]}},{"text":"%spark2.spark\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.ml.feature.VectorAssembler\nval testds = activePlayers.limit(100000)\nval vecAss = new VectorAssembler().setInputCols(Array(\"player_dist_ride\", \"player_dist_walk\")).setOutputCol(\"feature\")\nval output = vecAss.transform(testds)\noutput.show\n\n","dateUpdated":"2018-04-06T23:48:09+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523049285478_1923332296","id":"20180403-192640_1044434847","dateCreated":"2018-04-06T21:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:273","user":"admin","dateFinished":"2018-04-06T23:48:16+0000","dateStarted":"2018-04-06T23:48:09+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.mllib.linalg.Vectors\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\ntestds: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n\nvecAss: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_e32264e0cad1\n\noutput: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 14 more fields]\n+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+--------------------+\n|                date|game_size|            match_id|match_mode|party_size|player_assists|player_dbno|  player_dist_ride|  player_dist_walk|player_dmg|player_kills|   player_name|player_survive_time|team_id|team_placement|             feature|\n+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+--------------------+\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|          2870.724|        1784.84778|       117|           1|      SnuffIes|            1106.32|      4|            18|[2870.724,1784.84...|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|2938.4072300000003|1756.0797100000002|       127|           1|        Ozon3r|           1106.315|      4|            18|[2938.40723000000...|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        224.157562|        67|           0|        bovize|            235.558|      5|            33|    [0.0,224.157562]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          92.93515|         0|           0|       sbahn87|            197.553|      5|            33|      [0.0,92.93515]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|        2619.07739|          2510.447|       175|           2|     GeminiZZZ|           1537.495|     14|            11|[2619.07739,2510....|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|         2896.3125|        2167.93213|        65|           0|      AlexWho6|             1537.5|     14|            11|[2896.3125,2167.9...|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        3118.58032|         0|           0|    R1dd1ck913|           1264.792|     15|            17|    [0.0,3118.58032]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          3237.202|         0|           0|     Emmylou89|           1264.795|     15|            17|      [0.0,3237.202]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|         1552.3147|        79|           0|         ron-n|             868.56|     17|            24|     [0.0,1552.3147]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|         1450.3147|       101|           1|       SoSpicy|            868.555|     17|            24|     [0.0,1450.3147]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|        2406.55469|        3100.02124|        54|           1|   MatthiasXIV|           1939.846|     22|             4|[2406.55469,3100....|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|        3135.38647|2456.2775899999997|        34|           0|      Ninjapex|           1939.851|     22|             4|[3135.38647,2456....|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        55.2714539|         0|           0|    thebrewski|             160.64|     24|            34|    [0.0,55.2714539]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|          129.4159|       215|           2|GucciManeDrain| 180.90099999999998|     24|            34|      [0.0,129.4159]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|          2418.547|        2474.08887|        75|           1|      subzero3|           2181.815|     25|             2|[2418.547,2474.08...|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|1277.5805699999999|        3286.67114|        84|           1|       Chogo82|            2181.82|     25|             2|[1277.58056999999...|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|          2057.258|         0|           0|    FIYMNBVCXZ| 1583.1570000000002|     26|             3|      [0.0,2057.258]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          4|               0.0|        3285.94385|       673|           6|     ShuLanHou| 2009.7220000000002|     26|             3|    [0.0,3285.94385]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          0|               0.0|        1522.11768|       117|           1|         sigbo| 1032.6480000000001|     29|            20|    [0.0,1522.11768]|\n|2017-11-26T20:59:...|       37|2U4GBNA0YmnNZYkzj...|       tpp|         2|             0|          1|               0.0|        1078.95581|       100|           1|       Jerryxp|            513.487|     29|            20|    [0.0,1078.95581]|\n+--------------------+---------+--------------------+----------+----------+--------------+-----------+------------------+------------------+----------+------------+--------------+-------------------+-------+--------------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%spark2.spark\nimport org.apache.spark.ml.clustering.KMeans\nval kmeans = new KMeans().setK(2).setSeed(1L).setFeaturesCol(\"feature\")\nval model = kmeans.fit(output)\n","user":"admin","dateUpdated":"2018-04-06T23:48:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523050446481_175040396","id":"20180406-213406_1057089700","dateCreated":"2018-04-06T21:34:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1097","dateFinished":"2018-04-06T23:48:33+0000","dateStarted":"2018-04-06T23:48:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.clustering.KMeans\n\nkmeans: org.apache.spark.ml.clustering.KMeans = kmeans_6677298b7430\n\nmodel: org.apache.spark.ml.clustering.KMeansModel = kmeans_6677298b7430\n"}]}},{"text":"%spark2.spark\n\n\n// Shows the result.\nprintln(\"Cluster Centers: \")\nmodel.clusterCenters.foreach(println)","user":"admin","dateUpdated":"2018-04-06T23:48:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523056260404_1442441317","id":"20180406-231100_345323547","dateCreated":"2018-04-06T23:11:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1594","dateFinished":"2018-04-06T23:48:41+0000","dateStarted":"2018-04-06T23:48:41+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Cluster Centers: \n[302.5548006767352,1017.7987312506501]\n[4243.139405887645,2287.5022506167993]\n"}]}},{"text":"%spark2.spark\n","user":"admin","dateUpdated":"2018-04-06T23:44:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523058294646_-1153579937","id":"20180406-234454_862421277","dateCreated":"2018-04-06T23:44:54+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2196"}],"name":"/csye7200/ingest","id":"2DB3ADX93","angularObjects":{"2D9TCQ4EH:shared_process":[],"2DAGG4CBJ:shared_process":[],"2D9RXNEYM:shared_process":[],"2DC46GYM7:shared_process":[],"2D9PK98DX:shared_process":[],"2DCFX89Y3:shared_process":[],"2C4U48MY3_spark2:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}