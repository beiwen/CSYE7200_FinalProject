{"paragraphs":[{"text":"%spark2.spark\n\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.{Dataset, SparkSession}\n\nval schema: StructType = new StructType(Array(StructField(\"date\", StringType, false),\n    StructField(\"game_size\", IntegerType, false),\n    StructField(\"match_id\",StringType, false),\n    StructField(\"match_mode\", StringType, false),\n    StructField(\"party_size\", IntegerType, false),\n    StructField(\"player_assists\", IntegerType, false),\n    StructField(\"player_dbno\",IntegerType,false),\n    StructField(\"player_dist_ride\",DoubleType,false),\n    StructField(\"player_dist_walk\",DoubleType,false),\n    StructField(\"player_dmg\",IntegerType,false),\n    StructField(\"player_kills\",IntegerType,false),\n    StructField(\"player_name\",StringType,false),\n    StructField(\"player_survive_time\",DoubleType,false),\n    StructField(\"team_id\",IntegerType,false),\n    StructField(\"team_placement\",IntegerType,false))\n  )\n\ncase class Player (game_size: Int, match_id: String, match_mode: String, party_size: Int,\n                   player_assists: Int, player_dbno: Int, player_dist_ride: Double, player_dist_walk: Double,\n                   player_dmg: Int, player_kills: Int, player_name: String, player_survive_time: Double,\n                   team_id: Int, team_placement: Int)\n                   \ndef ingest(spark: SparkSession, srcDir: String, schema: StructType): Dataset[Player]  = {\n\n    import spark.implicits._\n\n    spark.read\n      .option(\"header\", \"true\")\n      .option(\"inferSchema\", \"false\")\n      .schema(schema)\n      .format(\"csv\")\n      .load(srcDir)\n      .as[Player]\n  }\n\nval path = \"s3a://csye7200.bucket.forfinal/testData/*\"\n\nval ds = ingest(spark, path, schema)","user":"admin","dateUpdated":"2018-04-22T05:15:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.types._\n\nimport org.apache.spark.sql.{Dataset, SparkSession}\n\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(date,StringType,false), StructField(game_size,IntegerType,false), StructField(match_id,StringType,false), StructField(match_mode,StringType,false), StructField(party_size,IntegerType,false), StructField(player_assists,IntegerType,false), StructField(player_dbno,IntegerType,false), StructField(player_dist_ride,DoubleType,false), StructField(player_dist_walk,DoubleType,false), StructField(player_dmg,IntegerType,false), StructField(player_kills,IntegerType,false), StructField(player_name,StringType,false), StructField(player_survive_time,DoubleType,false), StructField(team_id,IntegerType,false), StructField(team_placement,IntegerType,false))\n\ndefined class Player\n\ningest: (spark: org.apache.spark.sql.SparkSession, srcDir: String, schema: org.apache.spark.sql.types.StructType)org.apache.spark.sql.Dataset[Player]\n\npath: String = s3a://csye7200.bucket.forfinal/testData/*\n\nds: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524362819547_1172991762","id":"20180421-051000_2008985291","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T05:15:12+0000","dateFinished":"2018-04-22T05:15:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12576"},{"text":"%spark2.spark\nimport org.apache.spark.ml.classification.MultilayerPerceptronClassificationModel\nimport org.apache.spark.ml.clustering.KMeansModel\nobject models {\n    val nnModelForSolo = MultilayerPerceptronClassificationModel.load(\"s3a://csye7200.bucket.forfinal/Models/nnClassifierForSolo\")\n    val nnModelForDuo = MultilayerPerceptronClassificationModel.load(\"s3a://csye7200.bucket.forfinal/Models/nnClassifierForDuo\")\n    val nnModelForSquad = MultilayerPerceptronClassificationModel.load(\"s3a://csye7200.bucket.forfinal/Models/nnClassifierForSquad\")\n\n    val clusteringByDistForSolo = KMeansModel.load(\"s3a://csye7200.bucket.forfinal/Models/ClusteringByDistanceForSolo\")\n    val clusteringByDistForDuo = KMeansModel.load(\"s3a://csye7200.bucket.forfinal/Models/ClusteringByDistanceForDuo\")\n    val clusteringByDistForSquad = KMeansModel.load(\"s3a://csye7200.bucket.forfinal/Models/ClusteringByDistanceForSquad\")\n\n    val clusteringByBattleForSolo = KMeansModel.load(\"s3a://csye7200.bucket.forfinal/Models/ClusteringByBattleForSolo\")\n    val clusteringByBattleForDuo = KMeansModel.load(\"s3a://csye7200.bucket.forfinal/Models/ClusteringByBattleForDuo\")\n    val clusteringByBattleForSquad = KMeansModel.load(\"s3a://csye7200.bucket.forfinal/Models/ClusteringByBattleForSquad\")\n  }","user":"admin","dateUpdated":"2018-04-22T05:15:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.classification.MultilayerPerceptronClassificationModel\n\nimport org.apache.spark.ml.clustering.KMeansModel\n\ndefined object models\n"}]},"apps":[],"jobName":"paragraph_1524362819548_1171068017","id":"20180421-051114_1778032762","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T05:15:18+0000","dateFinished":"2018-04-22T05:15:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12577"},{"text":"%spark2.spark\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.ml.feature.{StandardScaler, VectorAssembler, Normalizer}\n\ndef filterPlayers(ds: Dataset[Player]): Dataset[Player] = {\n    val filterdPlayers = ds.filter(d => (d.player_dist_ride != 0 || d.player_dist_walk != 0)\n      && d.player_survive_time <= 2400\n      && d.team_placement > 0)\n    filterdPlayers\n  }\n\ndef dropCols(df: DataFrame): DataFrame = {\n    df.drop(\"date\",\"game_size\",\"match_id\",\"match_mode\",\"party_size\",\"player_name\",\"team_id\")\n  }\n\nobject Clustering {\n  \n  def createDfWithFeature(ds: Dataset[Player],inputCols: Array[String]): DataFrame = {\n    val vecAss = new VectorAssembler().setInputCols(inputCols).setOutputCol(\"unscaled_features\")\n    val assembledDf = vecAss.transform(ds)\n    val scaler = new StandardScaler().setInputCol(\"unscaled_features\").setOutputCol(\"features\")\n    val scalerModel = scaler.fit(assembledDf)\n    val scaledDf = scalerModel.transform(assembledDf)\n    dropCols(scaledDf)\n  }\n}\n\n\nobject Classification {\n  def createDfWithFeature(ds: Dataset[Player]): DataFrame ={\n    val isWinnerUdf = udf((placement: Int) => placement match {\n      case 1 => 1\n      case _ => 0\n    })\n    val colArray = Array(\"player_assists\", \"player_dbno\", \"player_dist_ride\", \"player_dist_walk\", \"player_dmg\", \"player_kills\", \"player_survive_time\")\n    val vecAss = new VectorAssembler().setInputCols(colArray).setOutputCol(\"feature_unnormalized\")\n    val normalizer = new Normalizer().setInputCol(\"feature_unnormalized\").setOutputCol(\"features\")\n    val df_temp_1 = vecAss.transform(ds)\n    val df_temp_2 = normalizer.transform(df_temp_1)\n    df_temp_2.withColumn(\"survived\", isWinnerUdf(df_temp_2(\"team_placement\")))\n  }\n}\n\n  val filteredDS = filterPlayers(ds)\n  val soloPlayers = filteredDS.filter(d => d.party_size == 1).cache()\n  val duoPlayers = filteredDS.filter(d => d.party_size == 2).cache()\n  val squadPlayers = filteredDS.filter(d => d.party_size == 4).cache()","user":"admin","dateUpdated":"2018-04-22T05:53:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.DataFrame\n\nimport org.apache.spark.ml.feature.{StandardScaler, VectorAssembler, Normalizer}\n\nfilterPlayers: (ds: org.apache.spark.sql.Dataset[Player])org.apache.spark.sql.Dataset[Player]\n\ndropCols: (df: org.apache.spark.sql.DataFrame)org.apache.spark.sql.DataFrame\n\ndefined object Clustering\n\ndefined object Classification\n\nfilteredDS: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n\nsoloPlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n\nduoPlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n\nsquadPlayers: org.apache.spark.sql.Dataset[Player] = [date: string, game_size: int ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524362819549_1170683268","id":"20180421-051155_683852006","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T05:15:41+0000","dateFinished":"2018-04-22T05:15:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12578"},{"text":"%spark2.spark\n\n    val inputCols = Array(\"player_dist_ride\", \"player_dist_walk\")\n    //Get the dateframe with features column\n    val soloDF_clustering_dist = Clustering.createDfWithFeature(soloPlayers, inputCols)\n    val duoDF_clustering_dist = Clustering.createDfWithFeature(duoPlayers, inputCols)\n    val squadDF_clustering_dist = Clustering.createDfWithFeature(squadPlayers, inputCols)\n    //Get the prediction result of clustering by distance\n    val solo_predicted_by_dist = models.clusteringByDistForSolo.transform(soloDF_clustering_dist).cache\n    val duo_predicted_by_dist = models.clusteringByDistForDuo.transform(duoDF_clustering_dist).cache\n    val squad_predicted_by_dist = models.clusteringByDistForSquad.transform(squadDF_clustering_dist).cache","user":"admin","dateUpdated":"2018-04-22T05:55:01+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ninputCols: Array[String] = Array(player_dist_ride, player_dist_walk)\n\nsoloDF_clustering_dist: org.apache.spark.sql.DataFrame = [player_assists: int, player_dbno: int ... 8 more fields]\n\nduoDF_clustering_dist: org.apache.spark.sql.DataFrame = [player_assists: int, player_dbno: int ... 8 more fields]\n\nsquadDF_clustering_dist: org.apache.spark.sql.DataFrame = [player_assists: int, player_dbno: int ... 8 more fields]\n\nsolo_predicted_by_dist: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [player_assists: int, player_dbno: int ... 9 more fields]\n\nduo_predicted_by_dist: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [player_assists: int, player_dbno: int ... 9 more fields]\n\nsquad_predicted_by_dist: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [player_assists: int, player_dbno: int ... 9 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524362819550_1171837515","id":"20180421-052340_1924022633","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T05:15:45+0000","dateFinished":"2018-04-22T05:23:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12579"},{"text":"%spark2.spark\n\n     val inputCols1 = Array(\"player_dmg\", \"player_kills\")\n     val inputCols2 = Array(\"player_assists\", \"player_dbno\", \"player_dmg\", \"player_kills\")\n     //Get the dateframe with features column\n     val soloDF_clustering_battle = Clustering.createDfWithFeature(soloPlayers, inputCols1)\n     val duoDF_clustering_battle = Clustering.createDfWithFeature(duoPlayers, inputCols2)\n     val squadDF_clustering_battle = Clustering.createDfWithFeature(squadPlayers, inputCols2)\n     //Get the prediction result of clustering by battle\n     val solo_predicted_by_battle = models.clusteringByBattleForSolo.transform(soloDF_clustering_battle).cache\n     val duo_predicted_by_battle = models.clusteringByBattleForDuo.transform(duoDF_clustering_battle).cache\n     val squad_predicted_by_battle = models.clusteringByBattleForSquad.transform(squadDF_clustering_battle).cache","user":"admin","dateUpdated":"2018-04-22T06:39:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ninputCols1: Array[String] = Array(player_dmg, player_kills)\n\ninputCols2: Array[String] = Array(player_assists, player_dbno, player_dmg, player_kills)\n\nsoloDF_clustering_battle: org.apache.spark.sql.DataFrame = [player_assists: int, player_dbno: int ... 8 more fields]\n\nduoDF_clustering_battle: org.apache.spark.sql.DataFrame = [player_assists: int, player_dbno: int ... 8 more fields]\n\nsquadDF_clustering_battle: org.apache.spark.sql.DataFrame = [player_assists: int, player_dbno: int ... 8 more fields]\n\nsolo_predicted_by_battle: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [player_assists: int, player_dbno: int ... 9 more fields]\n\nduo_predicted_by_battle: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [player_assists: int, player_dbno: int ... 9 more fields]\n\nsquad_predicted_by_battle: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [player_assists: int, player_dbno: int ... 9 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524362819550_1171837515","id":"20180421-053113_390535834","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T05:24:22+0000","dateFinished":"2018-04-22T05:24:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12580"},{"text":"%spark2.spark\n\n    val soloDF_classification = Classification.createDfWithFeature(soloPlayers)\n    val duoDF_classification = Classification.createDfWithFeature(duoPlayers)\n    val squadDF_classification = Classification.createDfWithFeature(squadPlayers)\n\n    val solo_classification = models.nnModelForSolo.transform(soloDF_classification).cache\n    val duo_classification = models.nnModelForDuo.transform(duoDF_classification).cache\n    val squad_classification = models.nnModelForSquad.transform(squadDF_classification).cache","user":"admin","dateUpdated":"2018-04-22T05:54:55+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nsoloDF_classification: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 16 more fields]\n\nduoDF_classification: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 16 more fields]\n\nsquadDF_classification: org.apache.spark.sql.DataFrame = [date: string, game_size: int ... 16 more fields]\n\nsolo_classification: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, game_size: int ... 17 more fields]\n\nduo_classification: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, game_size: int ... 17 more fields]\n\nsquad_classification: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [date: string, game_size: int ... 17 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524362819551_1171452766","id":"20180421-055459_1806413159","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T05:24:45+0000","dateFinished":"2018-04-22T05:24:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12581"},{"text":"%spark2.spark\nsolo_predicted_by_dist.createOrReplaceTempView(\"soloDist\")\nduo_predicted_by_dist.createOrReplaceTempView(\"duoDist\")\nsquad_predicted_by_dist.createOrReplaceTempView(\"squadDist\")\n\nsolo_predicted_by_battle.createOrReplaceTempView(\"soloBt\")\nduo_predicted_by_battle.createOrReplaceTempView(\"duoBt\")\nsquad_predicted_by_battle.createOrReplaceTempView(\"squadBt\")\n\nsolo_classification.createOrReplaceTempView(\"soloClass\")\nduo_classification.createOrReplaceTempView(\"duoClass\")\nsquad_classification.createOrReplaceTempView(\"squadClass\")\n\nsolo_predicted_by_dist.where(\"team_placement == 1\").createOrReplaceTempView(\"soloDistw\")\nduo_predicted_by_dist.where(\"team_placement == 1\").createOrReplaceTempView(\"duoDistw\")\nsquad_predicted_by_dist.where(\"team_placement == 1\").createOrReplaceTempView(\"squadDistw\")\n\nsolo_predicted_by_battle.where(\"team_placement == 1\").createOrReplaceTempView(\"soloBtw\")\nduo_predicted_by_battle.where(\"team_placement == 1\").createOrReplaceTempView(\"duoBtw\")\nsquad_predicted_by_battle.where(\"team_placement == 1\").createOrReplaceTempView(\"squadBtw\")\n\nval s_t_ratios = Range (0, 6) zip Array((solo_predicted_by_dist.where(\"team_placement == 1 and prediction == 0\").count.toDouble/solo_predicted_by_dist.where(\"prediction == 0\").count.toDouble),\n    (solo_predicted_by_dist.where(\"team_placement == 1 and prediction == 1\").count.toDouble/solo_predicted_by_dist.where(\"prediction == 1\").count.toDouble),\n    (solo_predicted_by_dist.where(\"team_placement == 1 and prediction == 2\").count.toDouble/solo_predicted_by_dist.where(\"prediction == 2\").count.toDouble),\n    (solo_predicted_by_dist.where(\"team_placement == 1 and prediction == 3\").count.toDouble/solo_predicted_by_dist.where(\"prediction == 3\").count.toDouble),\n    (solo_predicted_by_dist.where(\"team_placement == 1 and prediction == 4\").count.toDouble/solo_predicted_by_dist.where(\"prediction == 4\").count.toDouble),\n    (solo_predicted_by_dist.where(\"team_placement == 1 and prediction == 5\").count.toDouble/solo_predicted_by_dist.where(\"prediction == 5\").count.toDouble)\n)  \n\nspark.createDataFrame(s_t_ratios).createOrReplaceTempView(\"stView\")\n\nval d_t_ratios = Range (0, 5) zip Array((duo_predicted_by_dist.where(\"team_placement == 1 and prediction == 0\").count.toDouble/duo_predicted_by_dist.where(\"prediction == 0\").count.toDouble),\n    (duo_predicted_by_dist.where(\"team_placement == 1 and prediction == 1\").count.toDouble/duo_predicted_by_dist.where(\"prediction == 1\").count.toDouble),\n    (duo_predicted_by_dist.where(\"team_placement == 1 and prediction == 2\").count.toDouble/duo_predicted_by_dist.where(\"prediction == 2\").count.toDouble),\n    (duo_predicted_by_dist.where(\"team_placement == 1 and prediction == 3\").count.toDouble/duo_predicted_by_dist.where(\"prediction == 3\").count.toDouble)\n)  \n\nspark.createDataFrame(d_t_ratios).createOrReplaceTempView(\"dtView\")\n\nval sq_t_ratios = Range (0, 4) zip Array((squad_predicted_by_dist.where(\"team_placement == 1 and prediction == 0\").count.toDouble/squad_predicted_by_dist.where(\"prediction == 0\").count.toDouble),\n    (squad_predicted_by_dist.where(\"team_placement == 1 and prediction == 1\").count.toDouble/squad_predicted_by_dist.where(\"prediction == 1\").count.toDouble),\n    (squad_predicted_by_dist.where(\"team_placement == 1 and prediction == 2\").count.toDouble/squad_predicted_by_dist.where(\"prediction == 2\").count.toDouble),\n    (squad_predicted_by_dist.where(\"team_placement == 1 and prediction == 3\").count.toDouble/squad_predicted_by_dist.where(\"prediction == 3\").count.toDouble),\n    (squad_predicted_by_dist.where(\"team_placement == 1 and prediction == 4\").count.toDouble/squad_predicted_by_dist.where(\"prediction == 4\").count.toDouble)\n)  \n\nspark.createDataFrame(d_t_ratios).createOrReplaceTempView(\"sqtView\")\n\n","user":"admin","dateUpdated":"2018-04-22T06:39:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ns_t_ratios: scala.collection.immutable.IndexedSeq[(Int, Double)] = Vector((0,0.0011989388815276246), (1,0.04569787604809868), (2,0.029709116297230137), (3,0.0), (4,0.025625451142286575), (5,0.0))\n\nd_t_ratios: scala.collection.immutable.IndexedSeq[(Int, Double)] = Vector((0,0.011036346578452705), (1,0.05837757210131298), (2,0.004024144869215292), (3,0.02356020942408377))\n\nsq_t_ratios: scala.collection.immutable.IndexedSeq[(Int, Double)] = Vector((0,0.015839598174990453), (1,0.08103398508676636), (2,0.016272189349112426), (3,0.10330642701006748))\n"}]},"apps":[],"jobName":"paragraph_1524364004695_1577234208","id":"20180422-022644_162161596","dateCreated":"2018-04-22T02:26:44+0000","dateStarted":"2018-04-22T05:24:47+0000","dateFinished":"2018-04-22T05:27:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12582"},{"text":"%spark2.spark\nval s_b_ratios = Range (0, 5) zip Array((solo_predicted_by_battle.where(\"team_placement == 1 and prediction == 0\").count.toDouble/solo_predicted_by_battle.where(\"prediction == 0\").count.toDouble),\n    (solo_predicted_by_battle.where(\"team_placement == 1 and prediction == 1\").count.toDouble/solo_predicted_by_battle.where(\"prediction == 1\").count.toDouble),\n    (solo_predicted_by_battle.where(\"team_placement == 1 and prediction == 2\").count.toDouble/solo_predicted_by_battle.where(\"prediction == 2\").count.toDouble),\n    (solo_predicted_by_battle.where(\"team_placement == 1 and prediction == 3\").count.toDouble/solo_predicted_by_battle.where(\"prediction == 3\").count.toDouble),\n    (solo_predicted_by_battle.where(\"team_placement == 1 and prediction == 4\").count.toDouble/solo_predicted_by_battle.where(\"prediction == 4\").count.toDouble)\n)  \n\nspark.createDataFrame(s_b_ratios).createOrReplaceTempView(\"sbView\")\n\nval d_b_ratios = Range (0, 5) zip Array((duo_predicted_by_battle.where(\"team_placement == 1 and prediction == 0\").count.toDouble/duo_predicted_by_battle.where(\"prediction == 0\").count.toDouble),\n    (duo_predicted_by_battle.where(\"team_placement == 1 and prediction == 1\").count.toDouble/duo_predicted_by_battle.where(\"prediction == 1\").count.toDouble),\n    (duo_predicted_by_battle.where(\"team_placement == 1 and prediction == 2\").count.toDouble/duo_predicted_by_battle.where(\"prediction == 2\").count.toDouble),\n    (duo_predicted_by_battle.where(\"team_placement == 1 and prediction == 3\").count.toDouble/duo_predicted_by_battle.where(\"prediction == 3\").count.toDouble),\n    (duo_predicted_by_battle.where(\"team_placement == 1 and prediction == 4\").count.toDouble/duo_predicted_by_battle.where(\"prediction == 4\").count.toDouble)\n)  \n\nspark.createDataFrame(d_b_ratios).createOrReplaceTempView(\"dbView\")\n\nval sq_b_ratios = Range (0, 4) zip Array((squad_predicted_by_battle.where(\"team_placement == 1 and prediction == 0\").count.toDouble/squad_predicted_by_battle.where(\"prediction == 0\").count.toDouble),\n    (squad_predicted_by_battle.where(\"team_placement == 1 and prediction == 1\").count.toDouble/squad_predicted_by_battle.where(\"prediction == 1\").count.toDouble),\n    (squad_predicted_by_battle.where(\"team_placement == 1 and prediction == 2\").count.toDouble/squad_predicted_by_battle.where(\"prediction == 2\").count.toDouble),\n    (squad_predicted_by_battle.where(\"team_placement == 1 and prediction == 3\").count.toDouble/squad_predicted_by_battle.where(\"prediction == 3\").count.toDouble)\n)  \n\nspark.createDataFrame(sq_b_ratios).createOrReplaceTempView(\"sqbView\")\n","user":"admin","dateUpdated":"2018-04-22T06:36:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524376758946_100602840","id":"20180422-055918_1536038571","dateCreated":"2018-04-22T05:59:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20446","dateFinished":"2018-04-22T06:37:59+0000","dateStarted":"2018-04-22T06:36:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ns_b_ratios: scala.collection.immutable.IndexedSeq[(Int, Double)] = Vector((0,0.002307324282943287), (1,6.219826919476037E-5), (2,0.1738868284131919), (3,0.026905670438648735), (4,0.597914798206278))\n\nd_b_ratios: scala.collection.immutable.IndexedSeq[(Int, Double)] = Vector((0,0.0839514715475791), (1,0.0034510297775018173), (2,0.3616081476479856), (3,0.009164615999945768), (4,0.0411923778642184))\n\nsq_b_ratios: scala.collection.immutable.IndexedSeq[(Int, Double)] = Vector((0,0.08022527320060112), (1,0.014632664142878674), (2,0.2775944670084476), (3,0.057163764785217286))\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_dist_ride) avg_ride, AVG(player_dist_walk) avg_walk, prediction\nFROM soloDist\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T05:52:58+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_ride","index":0,"aggr":"sum"},{"name":"avg_walk","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524373200855_-313493648","id":"20180422-050000_1141891155","dateCreated":"2018-04-22T05:00:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14073","dateFinished":"2018-04-22T05:00:23+0000","dateStarted":"2018-04-22T05:00:22+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_ride\tavg_walk\tprediction\n14301.40030254473\t345111.22880057804\t5\n959.1707754487712\t2500.7631999337177\t4\n67579.47603589462\t704844.805141414\t3\n3136.07887937273\t1923.349244302185\t2\n6176.017947257062\t1872.8150061222232\t1\n16.76291458949162\t626.0789660085293\t0\n"}]}},{"text":"%spark2.sql\n-- WITH subquery AS(\n--     SELECT prediction, SUM(1) winner_num_of_cluster\n--     FROM soloDist WHERE team_placement=1\n--     GROUP BY prediction\n-- )\n-- SELECT * \n-- FROM subquery q2\n-- LEFT JOIN (\n--   SELECT prediction, SUM(1) total_num_of_cluster\n--     FROM soloDist\n--     GROUP BY prediction ORDER BY prediction\n-- ) AS winners\n-- ON winners.prediction = q2.prediction\n\nSELECT AVG(player_dist_ride) avg_ride, AVG(player_dist_walk) avg_walk, prediction\nFROM soloDist\nWHERE prediction != 3 AND prediction != 5\nGROUP BY prediction\nORDER BY prediction DESC\n","user":"admin","dateUpdated":"2018-04-22T05:31:30+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"prediction","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_ride","index":0,"aggr":"sum"},{"name":"avg_walk","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_ride\tavg_walk\tprediction\n959.1707754487719\t2500.7631999337173\t4\n3136.07887937273\t1923.349244302186\t2\n6176.017947257062\t1872.8150061222232\t1\n16.76291458949162\t626.0789660085293\t0\n"}]},"apps":[],"jobName":"paragraph_1524363890025_-596532492","id":"20180422-022450_858169104","dateCreated":"2018-04-22T02:24:50+0000","dateStarted":"2018-04-22T04:56:31+0000","dateFinished":"2018-04-22T04:56:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12583"},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM soloDist WHERE team_placement=1\n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T04:50:01+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t26591\n4\t45015\n2\t44893\n0\t8748\n"}]},"apps":[],"jobName":"paragraph_1524369338636_1109223538","id":"20180422-035538_12843689","dateCreated":"2018-04-22T03:55:38+0000","dateStarted":"2018-04-22T03:55:58+0000","dateFinished":"2018-04-22T03:55:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12584"},{"text":"%spark2.sql\nSELECT _1 prediction, _2 winratio FROM stView\n\n","user":"admin","dateUpdated":"2018-04-22T04:50:00+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinratio\n0\t0.0011989388815276246\n1\t0.04569787604809868\n2\t0.029709116297230137\n3\t0.0\n4\t0.025625451142286575\n5\t0.0\n"}]},"apps":[],"jobName":"paragraph_1524369577355_1243424807","id":"20180422-035937_1718178954","dateCreated":"2018-04-22T03:59:37+0000","dateStarted":"2018-04-22T04:49:24+0000","dateFinished":"2018-04-22T04:49:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12585"},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM soloDist \n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T05:47:47+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t581887\n3\t495\n5\t346\n4\t1756652\n2\t1511085\n0\t7296452\n"}]},"apps":[],"jobName":"paragraph_1524369374102_2036899109","id":"20180422-035614_1313466369","dateCreated":"2018-04-22T03:56:14+0000","dateStarted":"2018-04-22T04:11:09+0000","dateFinished":"2018-04-22T04:11:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12586"},{"text":"%spark2.sql\nSELECT AVG(player_dist_ride) avg_ride, AVG(player_dist_walk) avg_walk, prediction\nFROM duoDist\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T05:31:00+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_ride","index":0,"aggr":"sum"},{"name":"avg_walk","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524373474058_-1316535675","id":"20180422-050434_1498389771","dateCreated":"2018-04-22T05:04:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14644","dateFinished":"2018-04-22T05:05:09+0000","dateStarted":"2018-04-22T05:05:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_ride\tavg_walk\tprediction\n73526.72217030836\t749771.0739528793\t3\n24080.260360556724\t317614.70882092556\t2\n4173.990831936645\t2091.680375035038\t1\n271.012697361451\t980.0652323387691\t0\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_dist_ride) avg_ride, AVG(player_dist_walk) avg_walk, prediction\nFROM duoDist WHERE prediction != 2 AND prediction != 3\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T05:32:12+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_ride","index":0,"aggr":"sum"},{"name":"avg_walk","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524375065315_2106842902","id":"20180422-053105_1322741139","dateCreated":"2018-04-22T05:31:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16649","dateFinished":"2018-04-22T05:31:51+0000","dateStarted":"2018-04-22T05:31:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_ride\tavg_walk\tprediction\n4173.990831936645\t2091.680375035039\t1\n271.0126973614509\t980.0652323387689\t0\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM duoDist WHERE team_placement=1\n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T05:37:28+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524373827201_-381871159","id":"20180422-051027_1856604396","dateCreated":"2018-04-22T05:10:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15179","dateFinished":"2018-04-22T05:27:33+0000","dateStarted":"2018-04-22T05:27:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t232162\n3\t9\n2\t2\n0\t148279\n"}]}},{"text":"%spark2.sql\nSELECT _1 prediction, _2 winratio FROM dtView","user":"admin","dateUpdated":"2018-04-22T05:38:19+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524373845289_-1371814755","id":"20180422-051045_320068147","dateCreated":"2018-04-22T05:10:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15270","dateFinished":"2018-04-22T05:29:17+0000","dateStarted":"2018-04-22T05:29:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinratio\n0\t0.011036346578452705\n1\t0.05837757210131298\n2\t0.004024144869215292\n3\t0.02356020942408377\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM duoDist \n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T05:39:30+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524373852535_-960686747","id":"20180422-051052_148771465","dateCreated":"2018-04-22T05:10:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15336","dateFinished":"2018-04-22T05:30:23+0000","dateStarted":"2018-04-22T05:30:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t3976904\n3\t382\n2\t497\n0\t13435515\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_dist_ride) avg_ride, AVG(player_dist_walk) avg_walk, prediction\nFROM squadDist\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T05:35:47+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_ride","index":0,"aggr":"sum"},{"name":"avg_walk","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524375194733_-42548344","id":"20180422-053314_519610943","dateCreated":"2018-04-22T05:33:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17077","dateFinished":"2018-04-22T05:34:04+0000","dateStarted":"2018-04-22T05:33:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_ride\tavg_walk\tprediction\n78003.44726560815\t742900.1201683414\t4\n5715.060407089398\t2121.89698272238\t3\n22576.664409230787\t317537.01189349114\t2\n2563.72129698525\t2360.487955000272\t1\n107.79301107753486\t897.9747079385413\t0\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_dist_ride) avg_ride, AVG(player_dist_walk) avg_walk, prediction\nFROM squadDist WHERE prediction != 2 AND prediction != 4\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T05:36:14+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_ride","index":0,"aggr":"sum"},{"name":"avg_walk","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524375318812_-827299827","id":"20180422-053518_498534708","dateCreated":"2018-04-22T05:35:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17536","dateFinished":"2018-04-22T05:35:47+0000","dateStarted":"2018-04-22T05:35:45+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_ride\tavg_walk\tprediction\n5715.060407089398\t2121.89698272238\t3\n2563.72129698525\t2360.487955000272\t1\n107.79301107753486\t897.9747079385413\t0\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM squadDist WHERE team_placement=1\n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T05:58:07+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524375437074_274037059","id":"20180422-053717_373283858","dateCreated":"2018-04-22T05:37:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17973","dateFinished":"2018-04-22T05:37:41+0000","dateStarted":"2018-04-22T05:37:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t486794\n3\t295282\n4\t21\n2\t11\n0\t264493\n"}]}},{"text":"%spark2.sql\nSELECT _1 prediction, _2 winratio FROM sqtView","user":"admin","dateUpdated":"2018-04-22T05:58:55+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524375501495_193868081","id":"20180422-053821_1751143002","dateCreated":"2018-04-22T05:38:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18276","dateFinished":"2018-04-22T05:39:03+0000","dateStarted":"2018-04-22T05:39:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinratio\n0\t0.011036346578452705\n1\t0.05837757210131298\n2\t0.004024144869215292\n3\t0.02356020942408377\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM squadDist \n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T05:41:40+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524375580048_264215833","id":"20180422-053940_1543158506","dateCreated":"2018-04-22T05:39:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18631","dateFinished":"2018-04-22T05:40:20+0000","dateStarted":"2018-04-22T05:40:18+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t6007282\n3\t2858312\n4\t398\n2\t676\n0\t16698214\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_dmg) avg_dmg, prediction\nFROM soloBt\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T06:12:13+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_dmg","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524376362277_-726806509","id":"20180422-055242_700127270","dateCreated":"2018-04-22T05:52:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19334","dateFinished":"2018-04-22T05:55:47+0000","dateStarted":"2018-04-22T05:55:18+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_dmg\tprediction\n1300.5564349775784\t4\n333.9171837560077\t3\n627.6839266228819\t2\n23.23648514649972\t1\n143.3764083883184\t0\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_kills) avg_kill, prediction\nFROM soloBt\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T05:57:51+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_kill","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524376600196_-1060262857","id":"20180422-055640_616148075","dateCreated":"2018-04-22T05:56:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19787","dateFinished":"2018-04-22T05:57:09+0000","dateStarted":"2018-04-22T05:57:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_kill\tprediction\n12.697421524663676\t4\n2.962501211928143\t3\n5.928446427468478\t2\n0.010997207590794004\t1\n1.2333326407897767\t0\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM soloBt WHERE team_placement=1\n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T06:19:07+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524376676927_-1678799526","id":"20180422-055756_1258079691","dateCreated":"2018-04-22T05:57:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20147","dateFinished":"2018-04-22T05:58:25+0000","dateStarted":"2018-04-22T05:58:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t382\n3\t31081\n4\t26667\n2\t59121\n0\t7996\n"}]}},{"text":"%spark2.sql\nSELECT _1 prediction, _2 winratio FROM sbView","user":"admin","dateUpdated":"2018-04-22T06:25:54+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524376719177_-571430895","id":"20180422-055839_873830080","dateCreated":"2018-04-22T05:58:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20361","dateFinished":"2018-04-22T06:23:41+0000","dateStarted":"2018-04-22T06:23:41+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinratio\n0\t0.002307324282943287\n1\t6.219826919476037E-5\n2\t0.1738868284131919\n3\t0.026905670438648735\n4\t0.597914798206278\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM soloBt\n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T06:16:47+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524377238905_-380462980","id":"20180422-060718_938018080","dateCreated":"2018-04-22T06:07:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20769","dateFinished":"2018-04-22T06:07:46+0000","dateStarted":"2018-04-22T06:07:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t6141650\n3\t1155184\n4\t44600\n2\t339997\n0\t3465486\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_dmg) avg_dmg, prediction\nFROM duoBt\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T06:33:34+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_dmg","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524377369799_-1386814505","id":"20180422-060929_1928248924","dateCreated":"2018-04-22T06:09:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:21056","dateFinished":"2018-04-22T06:10:34+0000","dateStarted":"2018-04-22T06:10:29+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_dmg\tprediction\n151.54084822129917\t4\n162.54917916838968\t3\n931.2836444165782\t2\n32.41751210800047\t1\n426.9274060148548\t0\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_kills) avg_kill, AVG(player_dbno) avg_dbno, AVG(player_assists) avg_assis, prediction\nFROM duoBt\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T06:38:52+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":3,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_kill","index":0,"aggr":"sum"},{"name":"avg_dbno","index":1,"aggr":"sum"},{"name":"avg_assis","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524377514991_-718274159","id":"20180422-061154_604448577","dateCreated":"2018-04-22T06:11:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:21455","dateFinished":"2018-04-22T06:28:23+0000","dateStarted":"2018-04-22T06:28:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_kill\tavg_dbno\tavg_assis\tprediction\n0.8458966189707142\t0.49284057989229135\t1.2592506477809966\t4\n1.253196441443579\t1.0710224409600058\t1.129843923360427E-6\t3\n8.328458088164368\t4.761679688755988\t1.113195717179512\t2\n0.09522488242061723\t0.009040917109087682\t0.0\t1\n3.784795502024103\t2.253334889534064\t0.46749173094678836\t0\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM duoBt WHERE team_placement=1\n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T06:35:40+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524377675601_-218071585","id":"20180422-061435_320962770","dateCreated":"2018-04-22T06:14:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:21794","dateFinished":"2018-04-22T06:14:58+0000","dateStarted":"2018-04-22T06:14:55+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t30758\n3\t40557\n4\t98326\n2\t89971\n0\t120840\n"}]}},{"text":"%spark2.sql\nSELECT _1 prediction, _2 winratio FROM dbView","user":"admin","dateUpdated":"2018-04-22T06:35:45+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524377714651_-1824752343","id":"20180422-061514_1401693769","dateCreated":"2018-04-22T06:15:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22034","dateFinished":"2018-04-22T06:26:04+0000","dateStarted":"2018-04-22T06:26:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinratio\n0\t0.0839514715475791\n1\t0.0034510297775018173\n2\t0.3616081476479856\n3\t0.009164615999945768\n4\t0.0411923778642184\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM duoBt \n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T06:37:27+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524378020138_2038854181","id":"20180422-062020_1643224516","dateCreated":"2018-04-22T06:20:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22590","dateFinished":"2018-04-22T06:30:50+0000","dateStarted":"2018-04-22T06:30:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t8912702\n3\t4425390\n4\t2386995\n2\t248808\n0\t1439403\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_dmg) avg_dmg, prediction\nFROM squadBt\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T06:33:22+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_dmg","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524378748246_619156455","id":"20180422-063228_6784188","dateCreated":"2018-04-22T06:32:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23720","dateFinished":"2018-04-22T06:33:00+0000","dateStarted":"2018-04-22T06:32:57+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_dmg\tprediction\n292.7056578993909\t3\n761.8049129235554\t2\n54.12772000302306\t1\n139.86712620433045\t0\n"}]}},{"text":"%spark2.sql\nSELECT AVG(player_kills) avg_kill, AVG(player_dbno) avg_dbno, AVG(player_assists) avg_assis, prediction\nFROM squadBt\nGROUP BY prediction\nORDER BY prediction DESC","user":"admin","dateUpdated":"2018-04-22T06:34:19+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"prediction","index":3,"aggr":"sum"}],"groups":[],"values":[{"name":"avg_kill","index":0,"aggr":"sum"},{"name":"avg_dbno","index":1,"aggr":"sum"},{"name":"avg_assis","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524378807510_-340129823","id":"20180422-063327_943393948","dateCreated":"2018-04-22T06:33:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:24053","dateFinished":"2018-04-22T06:33:55+0000","dateStarted":"2018-04-22T06:33:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_kill\tavg_dbno\tavg_assis\tprediction\n2.4531818104561443\t2.309773528759197\t0.2663854131592281\t3\n6.5749188259812\t5.568767019600815\t1.2643033571143028\t2\n0.23596309520859501\t0.28904532603514865\t0.0\t1\n0.7343320631165834\t0.6547329164828941\t1.39143995874041\t0\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM squadBt WHERE team_placement=1\n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T06:38:30+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524378905310_-1966160753","id":"20180422-063505_607623174","dateCreated":"2018-04-22T06:35:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:24471","dateFinished":"2018-04-22T06:35:40+0000","dateStarted":"2018-04-22T06:35:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t236790\n3\t248882\n2\t221514\n0\t339415\n"}]}},{"text":"%spark2.sql\nSELECT _1 prediction, _2 winratio FROM sqbView","user":"admin","dateUpdated":"2018-04-22T06:38:32+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524378910844_-1476360079","id":"20180422-063510_1523522420","dateCreated":"2018-04-22T06:35:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:24531","dateFinished":"2018-04-22T06:37:59+0000","dateStarted":"2018-04-22T06:37:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinratio\n0\t0.08022527320060112\n1\t0.014632664142878674\n2\t0.2775944670084476\n3\t0.057163764785217286\n"}]}},{"text":"%spark2.sql\nSELECT prediction, SUM(1) winner_num_of_cluster\n    FROM squadBt \n    GROUP BY prediction","user":"admin","dateUpdated":"2018-04-22T06:38:38+0000","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524378917628_739793586","id":"20180422-063517_2024643778","dateCreated":"2018-04-22T06:35:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:24591","dateFinished":"2018-04-22T06:38:26+0000","dateStarted":"2018-04-22T06:38:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\twinner_num_of_cluster\n1\t16182289\n3\t4353842\n2\t797977\n0\t4230774\n"}]}},{"text":"%spark2.spark\n\nsolo_classification.where(\"survived == 1 and prediction == 1\").count\nsolo_classification.where(\"prediction == 1\").count","user":"admin","dateUpdated":"2018-04-22T02:18:55+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres20: Long = 1451\n\nres21: Long = 2251\n"}]},"apps":[],"jobName":"paragraph_1524362819552_1157217057","id":"20180421-061425_1720309957","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T02:18:55+0000","dateFinished":"2018-04-22T02:19:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12587"},{"text":"%spark2.spark\nduo_classification.where(\"survived == 1 and prediction == 1\").count\nduo_classification.where(\"prediction == 1\").count","user":"admin","dateUpdated":"2018-04-22T02:20:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres22: Long = 900\n\nres23: Long = 1743\n"}]},"apps":[],"jobName":"paragraph_1524362819553_1156832308","id":"20180421-061513_30013709","dateCreated":"2018-04-22T02:06:59+0000","dateStarted":"2018-04-22T02:20:46+0000","dateFinished":"2018-04-22T02:21:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12588"},{"text":"%spark2.spark\nsquad_classification.where(\"survived == 1 and prediction == 1\").count\nsquad_classification.where(\"prediction == 1\").count","user":"admin","dateUpdated":"2018-04-22T02:21:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nres24: Long = 0\n\nres25: Long = 0\n"}]},"apps":[],"jobName":"paragraph_1524363646553_-18976776","id":"20180422-022046_2097102860","dateCreated":"2018-04-22T02:20:46+0000","dateStarted":"2018-04-22T02:21:00+0000","dateFinished":"2018-04-22T02:24:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12589"},{"text":"%spark2.spark\n","user":"admin","dateUpdated":"2018-04-22T02:21:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524363660820_1505813764","id":"20180422-022100_2126301410","dateCreated":"2018-04-22T02:21:00+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12590"}],"name":"/csye7200/Integration_NoteBook","id":"2DAXWVRNR","angularObjects":{"2DAZKG7R5:shared_process":[],"2DDAD2M57:shared_process":[],"2DCEYBXAV:shared_process":[],"2DBJCHZ2B:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2DDZRMMAY:shared_process":[],"2DBR85VEZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}